<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Airbnb Alerts</title>
    <link rel="stylesheet" href="/styles.css">
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Airbnb Alerts</h1>
        <div id="auth-area">
          <button id="btn-logout" class="hidden secondary">Sign out</button>
        </div>
      </header>

      <main>

        <!-- ── Subscription / plan card ─────────────────────────────────── -->
        <section class="card hidden" id="subscription-card">
          <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px">
            <div>
              <h2 style="margin:0 0 4px">Your plan</h2>
              <div id="plan-summary" class="note">Loading…</div>
            </div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button id="btn-upgrade" class="primary">Upgrade plan</button>
              <button id="btn-manage-billing" class="secondary">Manage billing</button>
            </div>
          </div>

          <!-- Inline plan picker (revealed when upgrade clicked) -->
          <div id="upgrade-panel" class="hidden" style="margin-top:20px">
            <h3 style="margin:0 0 14px">Choose a plan</h3>
            <div id="plan-cards" style="display:flex;flex-direction:column;gap:12px;max-width:560px"></div>
            <div style="margin-top:16px;display:flex;gap:8px">
              <button id="btn-confirm-upgrade" class="primary" disabled>Continue to payment →</button>
              <button id="btn-cancel-upgrade" class="secondary">Cancel</button>
            </div>
          </div>
        </section>

        <!-- ── Create alert ─────────────────────────────────────────────── -->
        <section class="card hidden" id="create-alert-card">
          <h2>Create alert</h2>

          <div style="display:flex;gap:24px;align-items:flex-start;flex-wrap:wrap">

            <!-- URL-based search alert (primary) -->
            <div style="flex:2;min-width:300px">
              <h3 style="margin-top:0">Search alert — paste your Airbnb URL</h3>
              <p class="note" style="margin-bottom:10px">
                Go to Airbnb, apply all your filters, then copy the URL from your browser bar and paste it here.
                We'll monitor that exact search and notify you when new listings appear.
              </p>
              <div class="row">
                <input id="alert-search-url"
                  placeholder="https://www.airbnb.com/s/Barcelona--Spain/homes?checkin=…"
                  style="flex:1" />
              </div>
              <div class="row buttons">
                <button id="btn-create-url-alert">Save alert</button>
              </div>
            </div>

            <!-- Specific listing tracker (secondary) -->
            <div style="flex:1;min-width:240px">
              <h3 style="margin-top:0">Track a specific listing</h3>
              <p class="note" style="margin-bottom:10px">Get notified when a listing becomes available for your dates.</p>
              <div class="row">
                <input id="listing-id" placeholder="Listing ID (e.g. 12345678)" />
              </div>
              <div class="row">
                <input id="listing-url" placeholder="Listing URL" />
              </div>
              <div class="row">
                <label>Check-in <input id="check-in" type="date" /></label>
                <label>Check-out <input id="check-out" type="date" /></label>
              </div>
              <div class="row buttons">
                <button id="btn-save-listing">Save listing</button>
              </div>
            </div>

          </div>
        </section>

        <!-- ── Your alerts ──────────────────────────────────────────────── -->
        <section class="card hidden" id="alerts-card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
            <h2 style="margin:0">Your alerts</h2>
            <button id="btn-refresh" class="secondary" style="font-size:13px;padding:6px 10px">↻ Refresh</button>
          </div>
          <div id="alerts-list"></div>
        </section>

        <!-- ── Listings panel ───────────────────────────────────────────── -->
        <section class="card hidden" id="listings-panel">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
            <h2 style="margin:0">Listings <span id="listings-for-id"></span></h2>
            <div style="display:flex;gap:8px;align-items:center">
              <label style="font-size:13px;color:var(--muted)">Page size
                <select id="page-size" style="margin-left:6px">
                  <option>10</option>
                  <option selected>20</option>
                  <option>50</option>
                </select>
              </label>
              <button id="btn-prev-page" class="secondary">Prev</button>
              <button id="btn-next-page" class="secondary">Next</button>
              <button id="btn-load-more">Load more</button>
            </div>
          </div>
          <div id="listings-list"></div>
        </section>

        <!-- ── Confirm modal ────────────────────────────────────────────── -->
        <div id="confirm-modal" class="modal hidden" role="dialog" aria-modal="true">
          <div class="modal-backdrop" id="confirm-backdrop"></div>
          <div class="modal-content" style="max-width:420px">
            <div id="confirm-body" style="padding:12px">Are you sure?</div>
            <div style="display:flex;gap:8px;justify-content:flex-end;padding:12px">
              <button id="confirm-cancel" class="secondary">Cancel</button>
              <button id="confirm-ok">Confirm</button>
            </div>
          </div>
        </div>

        <!-- ── Listing details modal ────────────────────────────────────── -->
        <div id="listing-modal" class="modal hidden" role="dialog" aria-modal="true">
          <div class="modal-backdrop" id="modal-backdrop"></div>
          <div class="modal-content">
            <button id="modal-close" class="modal-close">×</button>
            <div id="modal-body"><div id="modal-loader">Loading…</div></div>
          </div>
        </div>

        <!-- ── Recent notifications ─────────────────────────────────────── -->
        <section class="card hidden" id="notifications-card">
          <h2>Recent notifications</h2>
          <div id="notifications-list"></div>
        </section>

        <div id="message" class="message hidden"></div>
      </main>

      <footer>
        <small style="color:var(--muted)">Airbnb Alerts</small>
      </footer>
    </div>

    <script src="/app.js"></script>
  </body>
</html>
